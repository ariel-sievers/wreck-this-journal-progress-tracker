function getSelectedPage(){const selectionService=new SelectionService,pagesService=new PagesService;return pagesService.getPage(parseInt(selectionService.selected))}function showPageDetails(page){let template,clone,complete,icon,list,pageDetails;pageDetails=document.body.querySelector(".page-details"),pageDetails&&pageDetails.remove(),template=document.getElementsByTagName("template")[0],complete=template.content.querySelector("#complete"),"true"===isComplete(page)?complete.classList.add("complete"):complete.classList.remove("complete"),icon=template.content.getElementById("favorite"),page.favorited?(icon.classList.add("favorite"),icon.innerHTML='<i class="fas fa-star"></i>'):icon.innerHTML='<i class="far fa-star"></i>',template.content.getElementById("page-number").innerHTML=page.pageNumber+".",template.content.getElementById("page-title").innerHTML=page.title,list=template.content.getElementById("idea-list"),loadIdeas(page,list),clone=document.importNode(template.content,!0),document.body.appendChild(clone)}function favorite(){const pagesService=new PagesService,page=getSelectedPage(),favorite=document.body.querySelector("#favorite"),favoriteIcon=favorite.querySelector(".fa-star");pagesService.favoritePage(page),favoriteIcon.classList.toggle("far"),favoriteIcon.classList.toggle("fas"),favorite.classList.toggle("favorite")}function goBack(){(new SelectionService).select(""),window.location.href="/"}function isComplete(page){return getCookie("checkboxValues").split(",")[page.pageNumber-1]}function markAsComplete(){const page=getSelectedPage(),complete=document.body.querySelector("#complete");let cookie=getCookie("checkboxValues").split(",");"false"===isComplete(page)?cookie[page.pageNumber-1]="true":cookie[page.pageNumber-1]="false",setCookie("checkboxValues",cookie.join(),365),complete.classList.toggle("complete")}function addIdea(){const page=getSelectedPage(),input=document.querySelector("#ideas-form input"),list=document.getElementById("idea-list");(new PagesService).addIdea(page,input.value),list.innerHTML+=`<hr><li>\n        <span>${input.value}</span>\n        <button onclick="remove(${page.ideas.length-1})"><i class="fas fa-minus-square"></i></button>\n    </li>`,toggleIdeaForm()}function toggleIdeaForm(){const form=document.getElementById("ideas-form"),input=form.querySelector("input");form.classList.toggle("show-form"),input.value="",input.focus()}function clearIdeas(){const page=getSelectedPage(),list=document.getElementById("idea-list");(new PagesService).resetIdeas(page),list.innerHTML=""}function remove(index){const page=getSelectedPage(),list=document.getElementById("idea-list");(new PagesService).removeIdea(page,index),loadIdeas(getSelectedPage(),list)}function loadIdeas(page,list){if(list.innerHTML="",page.ideas)for(let i=0;i<page.ideas.length;i++)list.innerHTML+=`<hr><li>\n                <span>${page.ideas[i]}</span>\n                <button onclick="remove(${i})"><i class="fas fa-minus-square"></i></button>\n            </li>`}function addIdeaOnEnter(event){const key=event.key||event.keyCode;"Enter"!==key&&13!==key||""===event.target.value||addIdea()}function jumpOnEnter(event){const key=event.key||event.keyCode,input=event.target;"Enter"!==key&&13!==key||(input.value>=input.min||input.value<=input.max)&&((new SelectionService).select(input.value),changePage())}function prevPage(){const selectionService=new SelectionService,selected=selectionService.selected;parseInt(selected)>document.querySelector("footer input").min&&(selectionService.select(--selectionService.selected),changePage())}function nextPage(){const selectionService=new SelectionService,selected=selectionService.selected;parseInt(selected)<document.querySelector("footer input").max&&(selectionService.select(++selectionService.selected),changePage())}function changePage(){const page=getSelectedPage();window.history.pushState({page:page.pageNumber},"",`?page=${page.pageNumber}`),showPageDetails(page),document.querySelector("footer input").value=page.pageNumber,checkPagination(page)}function checkPagination(page){const footer=document.querySelector("footer"),input=footer.querySelector("input"),arrows=footer.querySelectorAll("footer p");page.pageNumber>parseInt(input.min)&&page.pageNumber<parseInt(input.max)?(arrows[0].classList.remove("disabled"),arrows[2].classList.remove("disabled")):page.pageNumber<=parseInt(input.min)?arrows[0].classList.add("disabled"):arrows[2].classList.add("disabled")}window.onload=function(){let page;const selectionService=new SelectionService,url=window.location.href.split("?page=");url[1]&&selectionService.select(url[1]),page=getSelectedPage(),page?window.history.pushState({page:page.pageNumber},"",`?page=${page.pageNumber}`):window.location.href="/404.html",showPageDetails(page),document.body.querySelector("footer input").value=page.pageNumber,checkPagination(page)},window.onbeforeunload=function(){(new SelectionService).select(""),window.history.back()};